[gcode_macro LOOKUP_OBJECT]
gcode:
  {% set msg = [] %}
  {% set obj = printer.printer.lookup_object(params.OBJECT|default(None), default=None) %}
  {% if obj %}
    {% for name in obj.__dir__()|sort if not name.startswith('_') %}
      {% set attr = obj|attr(name) %}
      {% if attr is callable %}
        {% set _ = msg.append(name ~ " (callable)") %}
      {% else %}
        {% set _ = msg.append(name ~ " (attribute)") %}
      {% endif %}
    {% endfor %}
    {% if params.CALL is defined %}
      RESPOND MSG="{obj|attr(params.CALL)()}"
    {% else %}
      RESPOND MSG="{msg|join('<br>')}"
    {% endif %}
  {% else %}
    RESPOND MSG="no object found named: {obj}"
  {% endif %}
  